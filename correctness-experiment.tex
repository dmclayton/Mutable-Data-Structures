\begin{figure*}[t]
  \fourColsOneDivide{0.25}{.2}{.275}{.25}
  {
     \raisebox{-5pt}{\experimentv{$\Exp{\errep}_{\struct,d,r}(\advA)$ {\colorbox{lightgray}{$\Exp{\erreps}_{\struct,r}(\advA)$}}}}\\[2pt]
      $\setP \gets \emptyset$\\
      $\ct \gets 0$ \\
      $\key \getsr \keys$\\
      $i \getsr \advA^{\REPO,\UPO,\QRYO\highlighto{,\REVO}}$\\
      \colorbox{lightgray}{if $i \in \setP$ then return 0} \\[2.0pt]
      return $[\sum_\qry \err_i[\qry] \geq r]$ 
 }
{
    \oraclev{$\REPO(\col)$}\\[2pt]
      $\pub \getsr \Rep_\key(\col)$\\
      if $\pub = \bot$ return $\bot$\\
      $\ct\gets\ct+1$ \\
      $\pub_\ct \gets \pub$\\
      %$\setC_\ct \gets \emptyset$\\
      $\col_\ct \gets \col$\\
      $\mathrm{rv} \gets \pub_\ct$ \highlight{;\mathrm{rv} \gets \top} \\
      return $\mathrm{rv}$
  }
  {
    \oraclev{$\UPO(i, \up)$}\\[2pt]
%      $X \gets \col^{v[i]}_i
%      $v[i] \gets v[i]+1$\\
      $\pub \getsr \Up_\key(\pub_i, \up)$\\
      if $\pub = \bot$ return $\bot$\\
      $X \gets \col_i$ \\
      $\col_i \gets \up(X)$\\
      $\pub_i \getsr \pub$\\
%      $\setC_i \gets \emptyset$\\
      for $\qry$ in $\err_i$ do\\
      \tab $a \gets \Qry_K(\pub_i, \qry)$\\
      \tab if $\err_i[\qry] > d(a,\qry(\col_i))$ then\\
      \tab\tab$\err_i[\qry] \gets d(a,\qry(\col_i))$\\
      $\mathrm{rv} \gets \pub_i$ \highlight{;\mathrm{rv} \gets \top}\\
      return $\mathrm{rv}$
      \medskip
}
{
    \oraclev{$\QRYO(i, \qry)$}\\[2pt]
      if $\qry \in \setC_i$ then return $\bot$\\
%      $\setC_i \gets \setC \union \{\qry\}$\\
      $a \gets \Qry_K(\pub_i, \qry)$\\
      if $\err_i[\qry] < d(a,\qry(\col_i))$ then\\
      \tab$\err_i[\qry] \gets d(a,\qry(\col_i))$\\
      return $a$


      \medskip
    \oraclev{$\REVO(i)$}\\[2pt]
     $\setP \gets \setP \cup \{i\}$ \\
      return $\pub_i$

  }
  \caption{Two notions of adversarial correctness. The $\errep$ notion captures correctness when the representation is always known to the adversary, while the $\erreps$ notion captures correctness when the representation is secret.}
  \vspace{6pt}\hrule
  \label{fig:security}
\end{figure*}


\newcommand{\oneColCCS}[2]{
  \makebox[.3\textwidth]{
    \begin{tabular}{|@{\gamespadleft}l@{\gamespad}|}
    \hline
    \rule{0pt}{1\normalbaselineskip}
    \begin{minipage}[t]{#1\textwidth}\gamesfontsize
      #2 \vspace{6pt}
    \end{minipage} \\
    \hline
  \end{tabular}
  }
}

\begin{figure}[t]
\oneColCCS{0.25}
{
\oraclev{$H(X)$}\\[2pt]
$V \getsr \mathcal{V}$\\
if $\mathrm{T}[X] \neq \undefn$ then $V \gets \mathrm{T}[X]$\\
$\mathrm{T}[X]\gets V$\\
return~$V$
}
\caption{Pseudocode for a Random Oracle~$H$ with outputs in set $\mathcal{V}$}
\label{fig:ROM}
\end{figure}